<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>NFL Multivariate Analysis | Eric Matthew Rupinski </title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Utilizing NFL Data to Learn New Multivariate Analysis Techniques In College Level Multivariate Statistics Course">
    <meta name="generator" content="Hugo 0.115.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="https://emr89.github.io/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="NFL Multivariate Analysis" />
<meta property="og:description" content="Utilizing NFL Data to Learn New Multivariate Analysis Techniques In College Level Multivariate Statistics Course" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://emr89.github.io/post/nfl-multivariate-analysis/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-02-09T10:58:08-04:00" />
<meta property="article:modified_time" content="2022-02-09T10:58:08-04:00" />
<meta itemprop="name" content="NFL Multivariate Analysis">
<meta itemprop="description" content="Utilizing NFL Data to Learn New Multivariate Analysis Techniques In College Level Multivariate Statistics Course"><meta itemprop="datePublished" content="2022-02-09T10:58:08-04:00" />
<meta itemprop="dateModified" content="2022-02-09T10:58:08-04:00" />
<meta itemprop="wordCount" content="4973">
<meta itemprop="keywords" content="Scene," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="NFL Multivariate Analysis"/>
<meta name="twitter:description" content="Utilizing NFL Data to Learn New Multivariate Analysis Techniques In College Level Multivariate Statistics Course"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  <header class="cover bg-top" style="background-image: url('https://emr89.github.io/images/NFL_1.jpeg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://emr89.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Eric Matthew Rupinski 
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://emr89.github.io/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://emr89.github.io/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://emr89.github.io/post/" title="Projects page">
              Projects
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <div class="f2 f1-l fw2 white-90 mb0 lh-title">NFL Multivariate Analysis</div>
          
            <div class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              Utilizing NFL Data to Learn New Multivariate Analysis Techniques In College Level Multivariate Statistics Course
            </div>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        PROJECTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">NFL Multivariate Analysis</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2022-02-09T10:58:08-04:00">February 9, 2022</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id="introduction">Introduction:</h2>
<p>This project is a collection of homework assignments for the college level course &ldquo;Multivariate Analysis&rdquo; at Rutgers University. The data used for all the homework assignments was self-created NFL Data Set from various online sources and used to track weekly performance for each team in each one of their matchups.</p>
<h5 id="there-are-14-homework-assignments-in-total-that-are-presented-as-one-project-the-following-statistical-topics-are-covered-in-the-project">There are 14 homework assignments in total that are presented as one project. The following statistical topics are covered in the project:</h5>
<ul>
<li>Finding Mean Vectors</li>
<li>Finding Variance-Covariance Matricies</li>
<li>Finding Correlation Matricies</li>
<li>Assessing Bivariate Normality in Pairs with Several Statistical Tests for Normality</li>
<li>Checking Data Set for Outliers &amp; Removing Them</li>
<li>Creating Bonferroni Confidence Intervals</li>
<li>Testing Given Numbers Supposedly Representing Means &amp; Testing Them Against Actual Population Means</li>
<li>Testing Mean Difference in Two Different Samples</li>
<li>Creating Multivariate Linear Models</li>
<li>Conducting Principal Component Analysis (PCA)</li>
<li>Obtaining Eigenvalue &amp; Eigenvector for PCA</li>
<li>Model Selection for Mulitvariate Models</li>
<li>Creating &amp; Analyzing Growth Curves</li>
<li>Conducting Explanatory Factor Analysis</li>
<li>Performing Maximum-Likelihood Factor Analysis Covariance Matrix W/ Loadings</li>
<li>Comparing Effectiveness of Various Factor Analysis</li>
<li>Computing Canonical Correlations &amp; Testing for Signifigance</li>
<li>Generating Helio Plots</li>
<li>Calculating Euclidean Distances</li>
<li>Creating Dendrograms</li>
<li>Conducting K-Means Clustering</li>
</ul>
<h5 id="note-some-reflections-and-answers-were-required-for-some-of-the-assignments-and-their-subsections-but-not-for-all-if-no-reflection-is-followed-after-the-creation-of-the-required-task-of-the-assignment-then-the-focus-was-just-the-process-of-the-creation">Note: Some reflections and answers were required for some of the assignments and their subsections, BUT not for all. If no reflection is followed after the creation of the required task of the assignment, then the focus was just the process of the creation.</h5>
<h2 id="assignment-task-guide">Assignment Task Guide:</h2>
<h5 id="assignment-1--find-the-mean-vector-variance-covariance-matrix-and-correlation-matrix">Assignment #1 = Find the Mean Vector, Variance-Covariance Matrix, and Correlation Matrix</h5>
<h5 id="assignment-2--assess-bivariate-normality-in-pairs">Assignment #2 = Assess Bivariate Normality in Pairs</h5>
<h5 id="assignment-3--bonferroni-confidence-intervals-test-hypothesis-that-provided-means-dodo-not-equalrepresent-actual-values">Assignment #3 = Bonferroni Confidence Intervals, Test hypothesis that provided means do/do not equal/represent actual values</h5>
<h5 id="assignment-4--test-for-difference-in-mean-vectors-between-two-different-samplestreatment-groups-construct-99-and-95-simultaneous-confidence-intervals-for-the-pairs-of-mean-components-what-treatments-if-any-appear-to-be-different--construct-95-bonferroni-cis-for-pairs-of-mean-components">Assignment #4 = Test for difference in mean vectors between two different samples/treatment groups, Construct 99% and 95% simultaneous confidence intervals for the pairs of mean components, what treatments, if any, appear to be different? &amp; Construct 95% bonferroni CIs for pairs of mean components</h5>
<h5 id="assignment-5--find-linear-models-for-4-variables-construct-a-95-prediction-interval-for-sqrtpy-prediction-with-values-teams--28-fd--21-comp--678-tay--86-sqrtry-87-bccay--362-create-multivariate-regression-model--create-95-prediction-interval">Assignment #5 = Find Linear Models for 4 variables, Construct a 95% Prediction Interval for sqrtPY prediction with values TEAMS = 28, FD = 21, COMP = 67.8, TAY = 8.6, sqrtRY= 8.7, BCCAY = 3.62, Create Multivariate Regression Model &amp; Create 95% Prediction Interval</h5>
<h5 id="assignment-6--construct-covariance-matrix-obtain-eigenvalue-and-eigenvector-for-pca-compute-total-portion-by-first-two-principle-components">Assignment #6 = Construct covariance matrix, obtain eigenvalue and eigenvector for PCA, compute total portion by first two Principle Components.</h5>
<h5 id="assignment-7--growth-curve-exercise-w-different-provided-data">Assignment #7 = Growth Curve Exercise w/ Different Provided Data</h5>
<h5 id="assignment-8--conducting-explanatory-factor-analysis-along-with-maximum-likelihood-factor-analysis-while-specifying-the-number-of-loadings--factors">Assignment #8 = Conducting Explanatory Factor Analysis, along with Maximum Likelihood Factor Analysis, While Specifying the Number of Loadings &amp; Factors</h5>
<h5 id="assignment-9--conducting-principle-component-analysis-pca-calculate-loadings--communalities--find-residuals--uniqueness">Assignment #9 = Conducting Principle Component Analysis (PCA), Calculate Loadings &amp; Communalities, &amp; Find Residuals &amp; Uniqueness</h5>
<h5 id="assignment-10--perform-factor-analysis-using-correlation-matrix-specifically-pca--factor-analysis-w-various-number-of-loadings--factors-then-reflect-on-if-it-matters-which-type-of-analysis-is-factored-or-not">Assignment #10 = Perform Factor Analysis Using Correlation Matrix, specifically PCA &amp; Factor Analysis w/ various number of Loadings &amp; Factors, Then Reflect on if it matters which type of analysis is factored or not.</h5>
<h5 id="assignment-11--conduct-factor-analysis--generate-the-following-specific-variances-communalities-proportion-of-variance-explained-by-each-factor-residual-matrix">Assignment #11 = Conduct Factor Analysis &amp; generate the following: specific variances, communalities, proportion of variance explained by each factor, residual matrix</h5>
<h5 id="assignment-12--compute-the-canonical-correlations-test-for-the-significance-of-the-canonical-correlations-with-alpha001-generate-two-plots-using-the-function-helioplot-one-plot-for-cv1-and-one-plot-for-cv2-write-a-paragraph-describing-the-information-displayed-in-the-plots">Assignment #12 = Compute the canonical correlations, Test for the significance of the canonical correlations with alpha=0.01, Generate two plots using the function helio.plot: one plot for cv=1 and one plot for cv=2, Write a paragraph describing the information displayed in the plots.</h5>
<h5 id="assignment-13--create-euclidean-distances-and-dendrograms-compare-results-and-determine-if-there-are-several-clusters">Assignment #13 = Create Euclidean Distances and dendrograms, compare results and determine if there are several clusters</h5>
<h5 id="assignment-14--conduct-k-means-clustering-algorithm-compare-to-assignment-13-are-there-about-the-right-number-of-clusters">Assignment #14 = Conduct K-Means Clustering algorithm, Compare to assignment 13, are there about the right number of clusters</h5>
<h2 id="data-set-description">Data Set Description:</h2>
<p>NFL Data that was constructed using a combination of sources such as the NFL, NEXT GEN STATS, ESPN, FOOTBALLDB. Data is TEAM based performance for match ups on a week to week basis
Data set called  &ldquo;WEEKlY TEAM PERFORMANCE&rdquo;, which will be used for individual team performance.</p>
<h3 id="explanation-of-variables">EXPLANATION OF VARIABLES:</h3>
<table>
<thead>
<tr>
<th><strong>Variable</strong></th>
<th><strong>Explanation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Team</td>
<td>(ID) which NFL TEAM that line of data in from the perspective of</td>
</tr>
<tr>
<td>Outcome</td>
<td>Binary, either (1,0), did the team win the game or not, 1 = Team WON, 0 = Team Lost</td>
</tr>
<tr>
<td>Opp</td>
<td>The name of the opposition/other team in the match up opposition/other team in the match up</td>
</tr>
<tr>
<td>TEAMS</td>
<td>The Team&rsquo;s score from the game, ex = scored 34 points in the game, TEAMS = 34</td>
</tr>
<tr>
<td>OPPS</td>
<td>The Opponents&rsquo; score from the game, ex had 21 points scored AGAINST the team during the game, OPPS = 17</td>
</tr>
<tr>
<td>FD</td>
<td># of first downs obtained by the Team throughout the ENTIRE game</td>
</tr>
<tr>
<td>PY</td>
<td># of Passing Yards obtained by the Team throughout the ENTIRE game</td>
</tr>
<tr>
<td>RY</td>
<td># of Rushing Yards obtained by the Team throughout the ENTIRE game</td>
</tr>
<tr>
<td>TO</td>
<td># of Turnovers (fumbles/Interceptions) PRODUCED by the Team throughout the ENTIRE game</td>
</tr>
<tr>
<td>DFD</td>
<td># of first downs obtained by the Opponent throughout the ENTIRE game</td>
</tr>
<tr>
<td>DPY</td>
<td># of Passing Yards obtained by the Opponent throughout the ENTIRE game</td>
</tr>
<tr>
<td>DRY</td>
<td># of Rushing Yards obtained by the Opponent throughout the ENTIRE game</td>
</tr>
<tr>
<td>DTO</td>
<td># of Turnovers (fumbles/Interceptions) PRODUCED by the Opponent throughout the ENTIRE game</td>
</tr>
<tr>
<td>TT</td>
<td>&ldquo;Time to Throw measures the average amount of time elapsed from the time of snap to throw on every pass attempt for a passer (sacks excluded)&rdquo; (Next Gen Stats)</td>
</tr>
<tr>
<td>CAY</td>
<td>Average amount of air yards on COMPLETED passes</td>
</tr>
<tr>
<td>AGG</td>
<td>Aggressiveness percent, the percentage of passes the Quarterback throws into tight coverage</td>
</tr>
<tr>
<td>LCAD</td>
<td>Longest completed Air distance throw for the entire game</td>
</tr>
<tr>
<td>AYTS</td>
<td>Average Yards to the Sticks, which is the amount of air yards ahead/behind the first down marker for all attempts for the passer</td>
</tr>
<tr>
<td>ATT</td>
<td>The total number of PASSING attempts the Quarterback attempts during the ENTIRE GAME</td>
</tr>
<tr>
<td>TD</td>
<td>The total number of PASSING Touchdowns the Quarterback THROWS the ENTIRE GAME</td>
</tr>
<tr>
<td>INT</td>
<td>The total number of PASSING INTERCEPTIONS the Quarterback THROWS the ENTIRE GAME</td>
</tr>
<tr>
<td>COMP</td>
<td>The Completion Percentage for the Quarterback over the ENTIRE GAME (RATIO OF PASSES COMPLETED/PASSES ATTEMPTED)</td>
</tr>
<tr>
<td>Week</td>
<td>The numbered week in the NFL season that the GAME occurred in</td>
</tr>
<tr>
<td>RUSHATT</td>
<td>The # of RUSHING attempts, attempted by primary running back/s</td>
</tr>
<tr>
<td>RUSHTD</td>
<td># of RUSHING Touchdowns scored by primary running back/s</td>
</tr>
<tr>
<td>EFF</td>
<td>The average efficiency of the running back/s in terms of running North/South. THE LOWER the number, the more of a North/South running back the average Running back is.</td>
</tr>
<tr>
<td>EM</td>
<td>the average percentage that there are 8+ defenders in the box, in terms of preparing for the running play</td>
</tr>
<tr>
<td>TLOS</td>
<td>the average amount of time the Running back stays behind the line of scrimmage from the start of the snap until when he crosses the line of scrimmage</td>
</tr>
<tr>
<td>AVG</td>
<td>the average # of yards the running back gains PER PLAY</td>
</tr>
<tr>
<td>CUSH</td>
<td>the average amount of cushion in terms of yard cushion a WR given per play</td>
</tr>
<tr>
<td>SEP</td>
<td>the average amount of separation a WR creates from a defensive back each play</td>
</tr>
<tr>
<td>TAY</td>
<td>average passing air yards for targets for each play</td>
</tr>
<tr>
<td>CTCH</td>
<td>the average catch percentage for the team per game</td>
</tr>
<tr>
<td>YACR</td>
<td>the average amount of yards attained AFTER the RECEPTION by WRs/TE PER PLAY(average for the entire team)</td>
</tr>
<tr>
<td>&mdash;</td>
<td>&mdash;</td>
</tr>
</tbody>
</table>
<h2 id="assignment-code-charts--findings">Assignment Code, Charts, &amp; Findings</h2>
<h3 id="basic-data-preparation">Basic Data Preparation</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Dimension of the data set
</span></span><span style="display:flex;"><span>dim(WTP)
</span></span></code></pre></div><p>There are 34 variables and 512 observations</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>Printing Data set:
</span></span><span style="display:flex;"><span>print(WTP)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Get rid of NA observations 
</span></span><span style="display:flex;"><span>WTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">na</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">omit</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Make data frame into a matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">WTPM</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-t</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span></code></pre></div><p><figure><img src="https://emr89.github.io/images/WTP1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/WTP2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/WTP3.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/WTP4.png"/>
</figure>
</p>
<h3 id="assignment-1">Assignment 1:</h3>
<p>Find the Mean Vector, Variance-Covariance Matrix, and Correlation Matrix</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Subset data for ease to New England Patriots 
</span></span><span style="display:flex;"><span>NEDF&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">subset</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">Team</span><span style="color:#f92672">=</span><span style="color:#e6db74">=&#34;NE&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NEDF</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NEDF</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">-1</span><span style="color:#960050;background-color:#1e0010">]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NEDF</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NEDF</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">-2</span><span style="color:#960050;background-color:#1e0010">]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NEM</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NEDF</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Find Mean vector Xbar
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xbarNE</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">rowMeans</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NEM</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>#print Xbar for NE
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xbarNE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Find Variance-Covariance Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">covNE</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cov</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NEM</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">NEM</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>#print Variance-Covariance Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">covNE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Find Correlation Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">corNE</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cor</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NEM</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">NEM</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>#print Correlation Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">corNE</span>
</span></span></code></pre></div><h4 id="results">Results:</h4>
<ul>
<li>xbarNE = The Mean Vector of the Data</li>
<li>covNE = The Variance-Covariance Matrix of the Data</li>
<li>corNE = The Correlation Matrix of the Data</li>
</ul>
<h3 id="assignment-2-work">Assignment #2 Work</h3>
<p>Assess Bivariate Normality in Pairs</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Library and Set up Dataset
</span></span><span style="display:flex;"><span>library(MVN)
</span></span><span style="display:flex;"><span>library(tidyverse)
</span></span><span style="display:flex;"><span>library(careless)
</span></span><span style="display:flex;"><span>library(psych)
</span></span><span style="display:flex;"><span>library(mclust)
</span></span><span style="display:flex;"><span>library(ppcc)
</span></span><span style="display:flex;"><span>A2WTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">12</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">20</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#All Major Tests For Normality:
</span></span><span style="display:flex;"><span>  #Mardia<span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">HZ</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">Royston</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">DH</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">Energy</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#mardia test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn1</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">A2WTP,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mardia&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#HZ test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn2</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">A2WTP,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hz&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Royston test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn3</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">A2WTP,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;royston&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#DH test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn4</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">A2WTP,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dh&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Energy test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn5</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">A2WTP,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;energy&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn5</span>
</span></span></code></pre></div><p><figure><img src="https://emr89.github.io/images/MVN1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVN2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVN3.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVN4.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVN5.png"/>
</figure>
</p>
<h4 id="normality-results">Normality Results:</h4>
<ul>
<li>Mardia = NO MULTIVARIATE NORMALITY</li>
<li>HZ = MULTIVARIATE NORMALITY</li>
<li>ROYSTON = NO MULTIVARIATE NORMALITY</li>
<li>DH = NO MULTIVARIATE NORMALITY</li>
<li>ENERGY = MULTIVARIATE NORMALITY</li>
</ul>
<p>Results: No, Yes, No, Yes, No</p>
<p>RESULTS ARE DUE TO &ldquo;TT&rdquo; VARIABLE NOT NORMALLY DISTRIBUTED</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#CHECK FOR OUTLIERS IN Dataset
</span></span><span style="display:flex;"><span>#Take Outliers out of data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#NOTE OUTLIER CODE WILL RUN IN R BUT WILL NOT KNIT 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  #Mutate WTP to calculate outliers
</span></span><span style="display:flex;"><span>AWTP &lt;<span style="color:#f92672">-WTP</span> <span style="color:#960050;background-color:#1e0010">%</span>&gt;%
</span></span><span style="display:flex;"><span> mutate(string = longstring(.)) %&gt;%
</span></span><span style="display:flex;"><span>mutate(md=outlier(.,plot = FALSE))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#USing Chi Squared, get rid of the outliers and reset the Dataset
</span></span><span style="display:flex;"><span>cutoff &lt;<span style="color:#f92672">-</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">qchisq</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">p</span><span style="color:#f92672">=</span><span style="color:#e6db74">1-0.001,</span> <span style="color:#a6e22e">df</span><span style="color:#f92672">=</span><span style="color:#e6db74">ncol(AWTP)))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">WTPC</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">AWTP</span> <span style="color:#960050;background-color:#1e0010">%</span>&gt;% 
</span></span><span style="display:flex;"><span> filter(string <span style="color:#960050;background-color:#1e0010">&lt;</span>= 10,
</span></span><span style="display:flex;"><span>         md&lt;<span style="color:#f92672">cutoff</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">%</span>&gt;%
</span></span><span style="display:flex;"><span>  select(-string,-md)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Remove all NAs 
</span></span><span style="display:flex;"><span>WTPCs_clustering &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">WTPC</span> <span style="color:#960050;background-color:#1e0010">%</span>&gt;%
</span></span><span style="display:flex;"><span> na.omit() 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># REDEFINE DATASET AND RETRYING NORMALITY TESTS 
</span></span><span style="display:flex;"><span>WTPCC&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTPCs_clustering</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SWTPCC</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">WTPCC</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">12</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">20</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#mardia test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn6</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">SWTPCC,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mardia&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn6</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#HZ test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn7</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">SWTPCC,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hz&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn7</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Royston test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn8</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">SWTPCC,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;royston&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#DH test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn9</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">SWTPCC,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dh&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn9</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Energy test for multivariate normality 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn10</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">SWTPCC,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;energy&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mvn10</span>
</span></span></code></pre></div><h4 id="results-1">RESULTS:</h4>
<ul>
<li>Mardia = MULTIVARIATE NORMALITY</li>
<li>HZ = MULTIVARIATE NORMALITY</li>
<li>ROYSTON = MULTIVARIATE NORMALITY</li>
<li>DH = MULTIVARIATE NORMALITY</li>
<li>ENERGY = MULTIVARIATE NORMALITY</li>
</ul>
<h4 id="results-yes-yes-yes-yes-yes">Results: Yes, Yes, Yes, Yes, Yes</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Markdown" data-lang="Markdown"><span style="display:flex;"><span>#Additional Test for Normality 
</span></span><span style="display:flex;"><span>#ProbPlot&lt;- ppccTest(SWTPCC, qfn=&#34;qnorm&#34;)
</span></span></code></pre></div><h4 id="result">Result:</h4>
<p>Test stated the differs from Normal Distrivution
Results: ALL TESTS STATE: MULTIVARIATE NORMALITY = TRUE (Except for Probility Plot Coefficent Correlation Test)
Which means that searching for outliers in the TT variable was effective and removing those outliers and standardizing lead to the distribution becoming normally distributed, most likely.</p>
<h3 id="assignment-3">Assignment 3:</h3>
<p>Bonferroni Confidence Intervals, Test hypothesis that provided means do/do not equal/represent actual values</p>
<p>Create Variance-Covariance Matrix and Correlation Matrix</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Library and Set Up Dataset:
</span></span><span style="display:flex;"><span>WTP&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">read_excel</span><span style="color:#960050;background-color:#1e0010">(&#34;</span><span style="color:#a6e22e">C:</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">Users</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">ericr</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">Desktop</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">NFL</span> <span style="color:#a6e22e">STATISTICS</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">NFL</span> <span style="color:#a6e22e">PROJECT</span> <span style="color:#a6e22e">DATA</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">T</span> <span style="color:#a6e22e">test</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">WTP</span> <span style="color:#a6e22e">AV</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">xlsx</span><span style="color:#960050;background-color:#1e0010">&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">DescTools</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">jocre</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">DFF1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">6</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">22</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SDF1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">DFF1</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">1:32</span><span style="color:#960050;background-color:#1e0010">,]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Covariance Matrix:
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">COVSDF1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cov</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">COVSDF1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Correlation Matrix:
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CORSDF1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cor</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CORSDF1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#95% ellipsoid 
</span></span><span style="display:flex;"><span>  #use <span style="color:#a6e22e">cset</span> <span style="color:#a6e22e">function</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">jocre</span> <span style="color:#a6e22e">package</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NFE1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cset</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">dat </span><span style="color:#f92672">=</span><span style="color:#e6db74">SDF1,</span> <span style="color:#a6e22e">method </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hotelling&#34;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">alpha </span><span style="color:#f92672">=</span> <span style="color:#e6db74">0.05)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NFE1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">xlim </span><span style="color:#f92672">=</span> <span style="color:#e6db74">c(15,30),ylim</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">60</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">70</span><span style="color:#960050;background-color:#1e0010">),</span>  <span style="color:#a6e22e">main </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CI Region btwn FD &amp; COMP&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#BONFERRONI CI Function 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">simult</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">ci</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">function</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">crit</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">value</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-sqrt</span><span style="color:#960050;background-color:#1e0010">(((</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">*(</span><span style="color:#a6e22e">n-1</span><span style="color:#960050;background-color:#1e0010">))/(</span><span style="color:#a6e22e">n-p</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">qf</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">05</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">n-p</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">lower</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">tail </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE)))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">paste</span><span style="color:#960050;background-color:#1e0010">(&#34;(&#34;,</span><span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)</span><span style="color:#a6e22e">-crit</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">value</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">var</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)/</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">),&#34;,&#34;,</span><span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)+</span><span style="color:#a6e22e">crit</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">value</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">var</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)/</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">),&#34;)&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bonferroni</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">cis</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">function</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">m</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">critical_value</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-qt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">05</span><span style="color:#960050;background-color:#1e0010">/(</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">m</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">n-1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">lower</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">tail </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">paste</span><span style="color:#960050;background-color:#1e0010">(&#34;(&#34;,</span><span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)</span><span style="color:#a6e22e">-critical_value</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">var</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)/</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">),&#34;,&#34;,</span><span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)+</span><span style="color:#a6e22e">critical_value</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">var</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)/</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">),&#34;)&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Set up for simultaneous CI For Test 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">n</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">32</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">p</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#simultaneous Hotelling CIS
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">simult</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">ci</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">FD</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">simult</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">ci</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">n</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Bonferroni CIs:
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bonferroni</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">cis</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">FD</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">32</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bonferroni</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">cis</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">32</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Function calculates and plots confidence intervals based on Hotellings&#39; T2 and Bonferroni procedure
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">working</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">hotelling</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">bonferroni</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">intervals</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">function</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">y</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">ggplot2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">library</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">gridExtra</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">y</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">y</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">x</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">n</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">length</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">y</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Get</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">fitted</span> <span style="color:#a6e22e">values</span> <span style="color:#a6e22e">of</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">linear</span> <span style="color:#a6e22e">model</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fit</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">y</span> <span style="color:#960050;background-color:#1e0010">~</span> <span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fit</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fit</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">fitted</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">values</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Find</span> <span style="color:#a6e22e">standard</span> <span style="color:#a6e22e">error</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">defined</span> <span style="color:#a6e22e">above</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">se</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sum</span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">y</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fit</span><span style="color:#960050;background-color:#1e0010">)^</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">))</span> <span style="color:#960050;background-color:#1e0010">*</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span> <span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#a6e22e">n</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">))^</span><span style="color:#a6e22e">2</span> <span style="color:#960050;background-color:#1e0010">/</span> 
</span></span><span style="display:flex;"><span>           <span style="color:#a6e22e">sum</span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">x</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">))^</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Calculate</span> <span style="color:#a6e22e">B</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">W</span> <span style="color:#a6e22e">statistics</span> <span style="color:#a6e22e">for</span> <span style="color:#a6e22e">both</span> <span style="color:#a6e22e">procedures</span><span style="color:#960050;background-color:#1e0010">.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">W</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">2</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">qf</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">p </span><span style="color:#f92672">=</span> <span style="color:#e6db74">0.95,</span> <span style="color:#a6e22e">df1 </span><span style="color:#f92672">=</span> <span style="color:#e6db74">2,</span> <span style="color:#a6e22e">df2 </span><span style="color:#f92672">=</span> <span style="color:#e6db74">n</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">1-qt</span><span style="color:#960050;background-color:#1e0010">(.</span><span style="color:#a6e22e">95</span><span style="color:#960050;background-color:#1e0010">/(</span><span style="color:#a6e22e">2</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">n</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Compute</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">simultaneous</span> <span style="color:#a6e22e">confidence</span> <span style="color:#a6e22e">intervals</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Working-Hotelling</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">wh</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">upper</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fit</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#a6e22e">W</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">se</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">wh</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">lower</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fit</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">W</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">se</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Bonferroni</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bon</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">upper</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fit</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">se</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bon</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">lower</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fit</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">se</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xy</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">y</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Plot</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">Working-Hotelling</span> <span style="color:#a6e22e">intervals</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">wh</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">ggplot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">xy</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x,</span> <span style="color:#a6e22e">y</span><span style="color:#f92672">=</span><span style="color:#e6db74">y))</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_point</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">2.5)</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">y</span><span style="color:#f92672">=</span><span style="color:#e6db74">fit,</span> <span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x),</span> <span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x,</span> <span style="color:#a6e22e">y</span><span style="color:#f92672">=</span><span style="color:#e6db74">wh.upper),</span> <span style="color:#a6e22e">colour</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">linetype</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dashed&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x,</span> <span style="color:#a6e22e">wh</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">lower</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">colour</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">linetype</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dashed&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span> <span style="color:#960050;background-color:#1e0010">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">labs</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Working-Hotelling&#39;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Plot</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">Bonferroni</span> <span style="color:#a6e22e">intervals</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">bonn</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">ggplot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">xy</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x,</span> <span style="color:#a6e22e">y</span><span style="color:#f92672">=</span><span style="color:#e6db74">y))</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_point</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">2.5)</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">y</span><span style="color:#f92672">=</span><span style="color:#e6db74">fit,</span> <span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x),</span> <span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x,</span> <span style="color:#a6e22e">y</span><span style="color:#f92672">=</span><span style="color:#e6db74">bon.upper),</span> <span style="color:#a6e22e">colour</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">linetype</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dashed&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span> <span style="color:#960050;background-color:#1e0010">+</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">geom_line</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">aes</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">x,</span> <span style="color:#a6e22e">bon</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">lower</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">colour</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">linetype</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dashed&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">size</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span> <span style="color:#960050;background-color:#1e0010">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">labs</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Bonferroni&#39;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">grid</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">arrange</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">wh</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">bonn</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">ncol </span><span style="color:#f92672">=</span> <span style="color:#e6db74">2)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Collect</span> <span style="color:#a6e22e">results</span> <span style="color:#a6e22e">of</span> <span style="color:#a6e22e">procedures</span> <span style="color:#a6e22e">into</span> <span style="color:#a6e22e">a</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">return</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">round</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">W</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">B</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">row</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">names </span><span style="color:#f92672">=</span> <span style="color:#e6db74">c(&#39;Result&#39;))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">colnames</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">res</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(&#39;</span><span style="color:#a6e22e">W</span><span style="color:#960050;background-color:#1e0010">&#39;,</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">B</span><span style="color:#960050;background-color:#1e0010">&#39;)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">return</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">res</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>#plotting FD and Comp variables from above with new function
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">working</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">hotelling</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">bonferroni</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">intervals</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">FD</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  #Hypothetical <span style="color:#a6e22e">Test</span> <span style="color:#a6e22e">if</span> <span style="color:#a6e22e">given</span> <span style="color:#a6e22e">mean</span> <span style="color:#a6e22e">values</span> <span style="color:#a6e22e">equal</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">actual</span> <span style="color:#a6e22e">mean</span> <span style="color:#a6e22e">values</span> <span style="color:#a6e22e">of</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">distribution</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MU_G</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">25</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">68</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">00</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">HotellingsT2Test</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">SDF1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">mu</span><span style="color:#f92672">=</span><span style="color:#e6db74">MU_G,test</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">f</span><span style="color:#960050;background-color:#1e0010">&#34;)</span>
</span></span></code></pre></div><p><figure><img src="https://emr89.github.io/images/Cov1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/Cor1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CI1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CI2.png"/>
</figure>
</p>
<h4 id="results-of-hotelling-test">Results of Hotelling Test:</h4>
<p>As expected, the given means of 25.0 for FD(First Downs) and 68 for COMP (Completion Percentage) are NOT the TRUE means for the distributions, as the true means are equal to ~ 20 first downs for FD and 63.77% completion percentage for COMP.</p>
<h3 id="assignment-4">Assignment 4:</h3>
<p>tTest for difference in mean vectors between two different samples/treatment groups, construct 99% and 95% simultaneous confidence intervals for the pairs of mean components, what treatments, if any, appear to be different, construct 95% bonferroni CIs for pairs of mean components</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Library and Set Up Dataset
</span></span><span style="display:flex;"><span>NESUB &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">subset</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">Team</span><span style="color:#f92672">=</span><span style="color:#e6db74">=&#34;NE&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NYJSUB</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">subset</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">Team</span><span style="color:#f92672">=</span><span style="color:#e6db74">=&#34;NYJ&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NESUB</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NESUB</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-3</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NYJSUB</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NYJSUB</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-3</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MNENY</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">rbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NESUB</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">NYJSUB</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  #Hotelling <span style="color:#a6e22e">Test:</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MNENY</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">MNENY</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-23:-28</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">HT2</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">with</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">MNENY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">HotellingsT2Test</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">outcome</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">TEAMS</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">OPPS</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">FD</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">PY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">RY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">TO</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">DFD</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">DRY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">DPY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">DTO</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">CAY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">AGG</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">LCAD</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">ATT</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">TD</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">INT</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">Week</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">CUSH</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">SEP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">TAY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">YACR</span><span style="color:#960050;background-color:#1e0010">)~</span><span style="color:#a6e22e">Team</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span></code></pre></div><h4 id="results-2">Results:</h4>
<p>p value = 0.07533302
Though this does not meet the threshold for alpha level of 0.05, this is a large data set and it does meet the alpha level of 0.1 and this is just an example, so we will continue with calculating CIs</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  #Two Sample T Test
</span></span><span style="display:flex;"><span>TWOSAMPLETTEST &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">function</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">x2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">level</span><span style="color:#960050;background-color:#1e0010">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-ncol</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-nrow</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">n2</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-nrow</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">x1bar</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">apply</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">x2bar</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">apply</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">mean</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cat</span><span style="color:#960050;background-color:#1e0010">(&#34;</span>\n <span style="color:#a6e22e">mean</span> <span style="color:#a6e22e">vector</span> <span style="color:#a6e22e">of</span> <span style="color:#a6e22e">population</span> <span style="color:#a6e22e">one</span> \n<span style="color:#960050;background-color:#1e0010">&#34;,</span> <span style="color:#a6e22e">x1bar</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cat</span><span style="color:#960050;background-color:#1e0010">(&#34;</span>\n\n <span style="color:#a6e22e">mean</span> <span style="color:#a6e22e">vector</span> <span style="color:#a6e22e">of</span> <span style="color:#a6e22e">population</span> <span style="color:#a6e22e">two</span> \n<span style="color:#960050;background-color:#1e0010">&#34;,</span> <span style="color:#a6e22e">x2bar</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">s1</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-cov</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">s2</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-cov</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">s</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">pool</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">n1-1</span><span style="color:#960050;background-color:#1e0010">)/(</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">n2-2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">s1</span><span style="color:#960050;background-color:#1e0010">+(</span><span style="color:#a6e22e">n2-1</span><span style="color:#960050;background-color:#1e0010">)/(</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">n2-2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">s2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tsq</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-t</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x1bar-x2bar</span><span style="color:#960050;background-color:#1e0010">)%*%</span><span style="color:#a6e22e">solve</span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n1</span> <span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">s</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">pool</span><span style="color:#960050;background-color:#1e0010">)%*%(</span><span style="color:#a6e22e">x1bar-x2bar</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">csq</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">n2-2</span><span style="color:#960050;background-color:#1e0010">)*(</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">/(</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">n2-p-1</span><span style="color:#960050;background-color:#1e0010">))*</span><span style="color:#a6e22e">qf</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">level</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">n2-p-1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">if</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">tsq</span>&gt;csq){
</span></span><span style="display:flex;"><span>    cat(&#34;\n\n reject equality of mean vectors\n \n&#34;)
</span></span><span style="display:flex;"><span>  cat(&#34;The coefficents of the linear combination \n of most responsible for the rejection is
</span></span><span style="display:flex;"><span>      \n&#34;, solve(s.pool)%*% (x1bar-x2bar))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>  else cat(&#34;\n\n do NOT reject equality of mean vectors\n \n&#34;)
</span></span><span style="display:flex;"><span>  scit&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">rep</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">nrow </span><span style="color:#f92672">=</span> <span style="color:#e6db74">p)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scib</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">rep</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">nrow </span><span style="color:#f92672">=</span> <span style="color:#e6db74">p)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">for</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">i</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">1:p</span><span style="color:#960050;background-color:#1e0010">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scit</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">]&lt;</span><span style="color:#a6e22e">-x1bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-x2bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scit</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">]&lt;</span><span style="color:#a6e22e">-x1bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-x2bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">csq</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">s</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">pool</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scit</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">]&lt;</span><span style="color:#a6e22e">-x1bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-x2bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]+</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">csq</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">s</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">pool</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scib</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">]&lt;</span><span style="color:#a6e22e">-x1bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-x2bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scib</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">]&lt;</span><span style="color:#a6e22e">-x1bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-x2bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-qt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1-</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1-level</span><span style="color:#960050;background-color:#1e0010">)/(</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">n2-2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">s</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">pool</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scib</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">]&lt;</span><span style="color:#a6e22e">-x1bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]</span><span style="color:#a6e22e">-x2bar</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">]+</span><span style="color:#a6e22e">qt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1-</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1-level</span><span style="color:#960050;background-color:#1e0010">)/(</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">*</span><span style="color:#a6e22e">p</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">n2-2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n1</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">n2</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">s</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">pool</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scit</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">Estimate</span><span style="color:#f92672">=</span><span style="color:#e6db74">scit[,1],LowerCI=scit[,2],UpperCI=scit[,3])</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">scib</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">Estimate</span><span style="color:#f92672">=</span><span style="color:#e6db74">scib[,1],LowerCI=scib[,2],UpperCI=scib[,3])</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cat</span><span style="color:#960050;background-color:#1e0010">(&#34;</span>\n <span style="color:#a6e22e">T</span> <span style="color:#a6e22e">Squared</span> <span style="color:#a6e22e">Based</span> <span style="color:#a6e22e">Simulatenous</span> <span style="color:#a6e22e">CI</span> <span style="color:#a6e22e">for</span> <span style="color:#a6e22e">Difference</span> \n<span style="color:#960050;background-color:#1e0010">&#34;)</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">print</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">scit</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">cat</span><span style="color:#960050;background-color:#1e0010">(&#34;</span>\n <span style="color:#a6e22e">Bonferroni</span> <span style="color:#a6e22e">Based</span> <span style="color:#a6e22e">Simulatenous</span> <span style="color:#a6e22e">CI</span> <span style="color:#a6e22e">for</span> <span style="color:#a6e22e">Difference</span> \n<span style="color:#960050;background-color:#1e0010">&#34;)</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">print</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">scib</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Comparing means from NFL DATA set for all variables between the New England Patriots and the New York Jets
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Set up Data Set Again
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NESUB &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">subset</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">Team</span><span style="color:#f92672">=</span><span style="color:#e6db74">=&#34;NE&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NYJSUB</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">subset</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">Team</span><span style="color:#f92672">=</span><span style="color:#e6db74">=&#34;NYJ&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NESUB</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NESUB</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-3</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NYJSUB</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NYJSUB</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-3</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MNENY</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">rbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NESUB</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">NYJSUB</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MNENY</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">MNENY</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-23:-28</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># x1 = New England Patriots
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">x1 </span><span style="color:#f92672">=</span> <span style="color:#e6db74">MNENY[1:16,]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#x2 = New York Jets 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">x2 </span><span style="color:#f92672">=</span> <span style="color:#e6db74">MNENY[17:32,]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Find Difference of Means 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NENYCTSTT</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">TWOSAMPLETTEST</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">x2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">95</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><p><figure><img src="https://emr89.github.io/images/CI3.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CI4.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CISUM.png"/>
</figure>
</p>
<h5 id="results-3">Results</h5>
<p>The following Results are the Hotellings&rsquo; T2 and Bonferroni Confidence Intervals
summary(NENYCTSTT)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#THIS CHUNK IS TO NORMALIZE ALL THE DATA FOR THE REGRESSION MODELS
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>WTP&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">read_excel</span><span style="color:#960050;background-color:#1e0010">(&#34;</span><span style="color:#a6e22e">C:</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">Users</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">ericr</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">Desktop</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">NFL</span> <span style="color:#a6e22e">STATISTICS</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">NFL</span> <span style="color:#a6e22e">PROJECT</span> <span style="color:#a6e22e">DATA</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">T</span> <span style="color:#a6e22e">test</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">WTP</span> <span style="color:#a6e22e">AV</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">xlsx</span><span style="color:#960050;background-color:#1e0010">&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">forecast</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-3</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">na</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">omit</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$OPPS  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$PY  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$RY  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$TO  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$DPY  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$DRY  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$DTO  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$TT &gt; 2 ,]
</span></span><span style="display:flex;"><span># &lt;- NWTP[NWTP$TT &lt; 3.4 ,]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">CAY</span>  &gt; 0,]
</span></span><span style="display:flex;"><span>NWTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">AGG</span>  <span style="color:#960050;background-color:#1e0010">&lt;</span> <span style="color:#a6e22e">40</span><span style="color:#960050;background-color:#1e0010">,]</span>
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$LCAD  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$ATT  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$TD  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$INT  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$RUSHATT  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$RUSHTD  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$EFF  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$EM  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$TLOS  &gt; 0,]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">AVG</span>  <span style="color:#960050;background-color:#1e0010">&lt;</span> <span style="color:#a6e22e">8</span><span style="color:#960050;background-color:#1e0010">,]</span>
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$SEP  &gt; 0,]
</span></span><span style="display:flex;"><span>#NWTP &lt;- NWTP[NWTP$CTCH  &gt; 0,]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">TAY</span>  <span style="color:#960050;background-color:#1e0010">&lt;</span> <span style="color:#a6e22e">20</span><span style="color:#960050;background-color:#1e0010">,]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">YACR</span>  <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">10</span> <span style="color:#960050;background-color:#1e0010">,]</span>
</span></span><span style="display:flex;"><span>#boxcox lambda list:
</span></span><span style="display:flex;"><span>#TO = NA  0.3008705
</span></span><span style="display:flex;"><span>#DTO = NA  0.3157798
</span></span><span style="display:flex;"><span>#CAY = 0.551116
</span></span><span style="display:flex;"><span>#AGG = 0.4273495
</span></span><span style="display:flex;"><span>  #ATT <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">2296755
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e"></span># TD = NA  0.4687738
</span></span><span style="display:flex;"><span>#INT = NA  0.1973087
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">  </span>#RUSHATT<span style="color:#a6e22e"> </span><span style="color:#f92672">=</span> <span style="color:#e6db74">-0.5606323</span>
</span></span><span style="display:flex;"><span>#RUSHTD = 0.2437525
</span></span><span style="display:flex;"><span>  #EFF <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">-0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">9999282
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">  </span>#EM<span style="color:#a6e22e"> </span><span style="color:#f92672">=</span> <span style="color:#e6db74">-0.1580629</span>
</span></span><span style="display:flex;"><span>  #AVG <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">6778013
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">  </span>#SEP<span style="color:#a6e22e"> </span><span style="color:#f92672">=</span> <span style="color:#e6db74">0.1241314</span>
</span></span><span style="display:flex;"><span>  #yacR <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">5778333</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">transform</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">sqrtPY </span><span style="color:#f92672">=</span> <span style="color:#e6db74">sqrt(PY),</span> <span style="color:#a6e22e">sqrtRY </span><span style="color:#f92672">=</span> <span style="color:#e6db74">sqrt(RY),</span> <span style="color:#a6e22e">BCTO </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(TO,</span> <span style="color:#a6e22e">lambda </span><span style="color:#f92672">=</span> <span style="color:#e6db74">0.3008705),</span> <span style="color:#a6e22e">sqrtDPY </span><span style="color:#f92672">=</span> <span style="color:#e6db74">sqrt(DPY),</span> <span style="color:#a6e22e">sqrtDRY </span><span style="color:#f92672">=</span> <span style="color:#e6db74">sqrt(DRY),</span> <span style="color:#a6e22e">BCDTO </span><span style="color:#f92672">=</span> <span style="color:#e6db74">log(DTO+1),</span> <span style="color:#a6e22e">BCCAY </span><span style="color:#f92672">=</span><span style="color:#e6db74">BoxCox(CAY,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span>  <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">551116</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCAGG </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(AGG,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">4273495</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">logLCAD </span><span style="color:#f92672">=</span> <span style="color:#e6db74">log(LCAD+1),</span> <span style="color:#a6e22e">BCATT </span><span style="color:#f92672">=</span><span style="color:#e6db74">BoxCox(ATT,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">2296755</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCTD </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(TD,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span><span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">4687738</span> <span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCINT </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(INT,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">1973087</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCRUSHATT </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(RUSHATT,</span> <span style="color:#a6e22e">lambda </span><span style="color:#f92672">=</span><span style="color:#e6db74">-0.5606323</span> <span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCRUSHTD </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(RUSHTD,</span> <span style="color:#a6e22e">lambda </span><span style="color:#f92672">=</span><span style="color:#e6db74">0.2437525</span> <span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCEFF </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(EFF,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">-0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">9999282</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCEM </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(EM,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">-0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">1580629</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">sqrtTLOS </span><span style="color:#f92672">=</span> <span style="color:#e6db74">sqrt(TLOS),</span> <span style="color:#a6e22e">BCAVG </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(AVG,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">6778013</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCSEP </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(SEP,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">1241314</span> <span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">BCYACR </span><span style="color:#f92672">=</span> <span style="color:#e6db74">BoxCox(YACR,lambda</span> <span style="color:#960050;background-color:#1e0010">=</span>  <span style="color:#a6e22e">0</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">5778333</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-5:-7</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-9:-11</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-13:-15</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-17:-19</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-21:-27</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-29</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-32</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#VARIABLES NOT NORMALLY DISTRIBUTED 
</span></span><span style="display:flex;"><span>  #BCSEP<span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCYACR</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCEM</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCRUSHATT</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCTO</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">BCDTO</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCAGG</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCATT</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCTD</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">BCINT</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">BCRUSHTD</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">NWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-14</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-17</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-19</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-21:-25</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-27</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">-30:-31</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MVNT2</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mardia&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><p>NWTP now consists of all normal or near normal distributions, even though it is not stated to be multivariate normal, will do regression anyway.</p>
<h3 id="assignment-5">Assignment #5:</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>A). Find Linear Models for 4 variables 
</span></span><span style="display:flex;"><span>  #finding best way with regsubsets package
</span></span><span style="display:flex;"><span>library(leaps)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#RegSubset to find best combination of variables
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  #Variable = sqrtPY
</span></span><span style="display:flex;"><span>RSPY&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">regsubsets</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">~.</span> <span style="color:#a6e22e">-TEAMS</span> <span style="color:#a6e22e">-OPPS</span> <span style="color:#a6e22e">-FD-DFD-sqrtRY-sqrtDPY-sqrtDRY-logLCAD</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP,</span> <span style="color:#a6e22e">intercept </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE,</span> <span style="color:#a6e22e">nbest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 4 variables
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSPY4</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">FD</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 5 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSPY5</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">TEAMS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">FD</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 6 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSPY6</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">TEAMS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">FD</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">TAY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> #Variable <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">sqrtRY</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSRY</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">regsubsets</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">~.</span> <span style="color:#a6e22e">-TEAMS</span> <span style="color:#a6e22e">-OPPS</span> <span style="color:#a6e22e">-FD-DFD-sqrtRY-sqrtDPY-sqrtDRY-logLCAD</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP,</span> <span style="color:#a6e22e">intercept </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE,</span> <span style="color:#a6e22e">nbest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 4 variables
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSRY4</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCAVG</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 5 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSRY5</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCAVG</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">TAY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 6 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSRY6</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCAVG</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">TAY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> #Variable <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">COMP</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSCOMP</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">regsubsets</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">~.</span> <span style="color:#a6e22e">-TEAMS</span> <span style="color:#a6e22e">-OPPS</span> <span style="color:#a6e22e">-FD-DFD-sqrtRY-sqrtDPY-sqrtDRY-logLCAD</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP,</span> <span style="color:#a6e22e">intercept </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE,</span> <span style="color:#a6e22e">nbest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 4 variables
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSCOMP4</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 5 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSCOMP5</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 6 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSCOMP6</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtTLOS</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> #Variable <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">TT</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSTT</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">regsubsets</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">~.</span> <span style="color:#a6e22e">-TEAMS</span> <span style="color:#a6e22e">-OPPS</span> <span style="color:#a6e22e">-FD-DFD-sqrtRY-sqrtDPY-sqrtDRY-logLCAD</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP,</span> <span style="color:#a6e22e">intercept </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE,</span> <span style="color:#a6e22e">nbest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 4 variables
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSTT4</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 5 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSTT5</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#best subset with 6 variables 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RSTT6</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">~</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">BCCAY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtTLOS</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Outlier Check:
</span></span><span style="display:flex;"><span>  #Note <span style="color:#a6e22e">Dataset</span> <span style="color:#a6e22e">was</span> <span style="color:#a6e22e">normalized</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">Outliers</span> <span style="color:#a6e22e">were</span> <span style="color:#a6e22e">Removed</span> <span style="color:#a6e22e">Earlier</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">file</span><span style="color:#960050;background-color:#1e0010">.</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Construct a 95% Prediction Interval for sqrtPY prediction with values TEAMS = 28, FD = 21, COMP = 67.8, TAY = 8.6, sqrtRY= 8.7, BCCAY = 3.62
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  #Creating <span style="color:#a6e22e">new</span> <span style="color:#a6e22e">dataframe</span> <span style="color:#a6e22e">for</span> <span style="color:#a6e22e">new</span> <span style="color:#a6e22e">predictions</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">plugging</span> <span style="color:#a6e22e">in:</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">nd</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">TEAMS </span><span style="color:#f92672">=</span> <span style="color:#e6db74">28,</span> <span style="color:#a6e22e">FD </span><span style="color:#f92672">=</span> <span style="color:#e6db74">21,</span> <span style="color:#a6e22e">COMP </span><span style="color:#f92672">=</span> <span style="color:#e6db74">67.8,</span> <span style="color:#a6e22e">TAY </span><span style="color:#f92672">=</span> <span style="color:#e6db74">8.6,</span> <span style="color:#a6e22e">sqrtRY</span><span style="color:#f92672">=</span> <span style="color:#e6db74">8.7,</span> <span style="color:#a6e22e">BCCAY </span><span style="color:#f92672">=</span> <span style="color:#e6db74">3.62)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">YHP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">predict</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">RSPY6</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">nd</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">interval </span><span style="color:#f92672">=</span> <span style="color:#e6db74">c(&#34;prediction&#34;),level=0.95))</span>
</span></span></code></pre></div><figure><img src="https://emr89.github.io/images/LM1.png"/>
</figure>

<h4 id="answer">Answer:</h4>
<p>~ (16.70816)^2 passing yards
= ~ 279.162 passing yards</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># B). #Multivariate Regression Model
</span></span><span style="display:flex;"><span>  # i). Fit Model and summary
</span></span><span style="display:flex;"><span>MVM1 &lt;<span style="color:#f92672">-</span>  <span style="color:#a6e22e">lm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">sqrtPY</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">COMP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">TT</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">sqrtRY</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">~</span> <span style="color:#a6e22e">CTCH</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">TEAMS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">sqrtTLOS</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">AYTS</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">data </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NWTP)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">MVM1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><h1 id="resulting-model-summary">Resulting Model Summary:</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Specify Matrix of Coefficents: 
</span></span><span style="display:flex;"><span>  coefficients(MVM1)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span># ii). Analyze Residuals and Check for Outliers
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  #Residuals of Multivariate Regression
</span></span><span style="display:flex;"><span>head(resid(MVM1))
</span></span><span style="display:flex;"><span>SH&lt;<span style="color:#f92672">-t</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">resid</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">MVM1</span><span style="color:#960050;background-color:#1e0010">))</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">resid</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">MVM1</span><span style="color:#960050;background-color:#1e0010">))/(</span><span style="color:#a6e22e">337-</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">5</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>#Calculating Multivariate Normal
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">MVMTN1</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">MVN::mvn</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">resid</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">MVM1</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">subset </span><span style="color:#f92672">=</span> <span style="color:#e6db74">NULL,</span> <span style="color:#a6e22e">mvnTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">c(&#34;mardia&#34;),</span> <span style="color:#a6e22e">covariance </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE,</span> <span style="color:#a6e22e">tol </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1e-25,</span> <span style="color:#a6e22e">alpha </span><span style="color:#f92672">=</span> <span style="color:#e6db74">0.5,</span> <span style="color:#a6e22e">scale </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE,</span> <span style="color:#a6e22e">desc </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE,</span> <span style="color:#a6e22e">transform </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">R </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1000,</span> <span style="color:#a6e22e">univariateTest </span><span style="color:#f92672">=</span> <span style="color:#e6db74">c(&#34;SW&#34;),</span> <span style="color:#a6e22e">univariatePlot </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">multivariatePlot </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;qq&#34;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">multivariateOutlierMethod </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;quan&#34;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">bc </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE,</span> <span style="color:#a6e22e">bcType </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;rounded&#34;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">showOutliers </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE,</span> <span style="color:#a6e22e">showNewData </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#summary of multivariate normal test  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MVMTN1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">multivariateNormality</span>
</span></span></code></pre></div><h4 id="results-4">Results</h4>
<p><figure><img src="https://emr89.github.io/images/MVM1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVM2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVM3.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVM4.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVMCOR.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVMQQ1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/MVMQQ2.png"/>
</figure>
</p>
<p>There appear to be ~ 11 outliers , and there is a slight negative skew to the distribution though, and the mardia test stated that the distribution is not normally distributed in the multivariate case.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#iii). Construct a Prediction Interval Given the following values 
</span></span><span style="display:flex;"><span>    # CTCH = 61.25, COMP = 65.45, sqrtTLOS = 1.654, TT = 2.73)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NDMT1&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">data</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">frame</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">AYTS </span><span style="color:#f92672">=</span> <span style="color:#e6db74">-0.2,</span> <span style="color:#a6e22e">TEAMS </span><span style="color:#f92672">=</span> <span style="color:#e6db74">35,</span> <span style="color:#a6e22e">CTCH </span><span style="color:#f92672">=</span> <span style="color:#e6db74">67.85,</span> <span style="color:#a6e22e">sqrtTLOS </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1.34)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Function for Simulatenous 95 CI
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pred</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mlm </span><span style="color:#f92672">=</span> <span style="color:#e6db74">function(object,</span> <span style="color:#a6e22e">newdata</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">level</span><span style="color:#f92672">=</span><span style="color:#e6db74">0.95,interval</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(&#34;</span><span style="color:#a6e22e">confidence</span><span style="color:#960050;background-color:#1e0010">&#34;,</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">prediction</span><span style="color:#960050;background-color:#1e0010">&#34;))</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">form </span><span style="color:#f92672">=</span> <span style="color:#e6db74">as.formula(paste(&#34;~&#34;,as.character(formula(object))[3]))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xnew </span><span style="color:#f92672">=</span> <span style="color:#e6db74">model.matrix(form,</span> <span style="color:#a6e22e">newdata</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fit </span><span style="color:#f92672">=</span> <span style="color:#e6db74">predict(object,</span> <span style="color:#a6e22e">newdata</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Y </span><span style="color:#f92672">=</span> <span style="color:#e6db74">model.frame(object)[,1]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">X </span><span style="color:#f92672">=</span> <span style="color:#e6db74">model.matrix(object)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">n </span><span style="color:#f92672">=</span> <span style="color:#e6db74">nrow(Y)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">m </span><span style="color:#f92672">=</span> <span style="color:#e6db74">ncol(Y)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">p </span><span style="color:#f92672">=</span> <span style="color:#e6db74">ncol(X)</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sigmas </span><span style="color:#f92672">=</span> <span style="color:#e6db74">colSums((Y</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">object</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">fitted</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">values</span><span style="color:#960050;background-color:#1e0010">)^</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">p</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">fit</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">var </span><span style="color:#f92672">=</span> <span style="color:#e6db74">diag(xnew</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">tcrossprod</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">solve</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">crossprod</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">X</span><span style="color:#960050;background-color:#1e0010">)),</span> <span style="color:#a6e22e">xnew</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">if</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">interval</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">]==&#34;</span><span style="color:#a6e22e">prediction</span><span style="color:#960050;background-color:#1e0010">&#34;)</span> <span style="color:#a6e22e">fit</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">var </span><span style="color:#f92672">=</span> <span style="color:#e6db74">fit.var</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#a6e22e">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">const </span><span style="color:#f92672">=</span> <span style="color:#e6db74">qf(level,</span> <span style="color:#a6e22e">df1</span><span style="color:#f92672">=</span><span style="color:#e6db74">m,</span> <span style="color:#a6e22e">df2</span><span style="color:#f92672">=</span><span style="color:#e6db74">n-p-m)</span> <span style="font-style:italic">* m *</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">p</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">n</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">p</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">m</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">vmat </span><span style="color:#f92672">=</span> <span style="color:#e6db74">(n/(n-p-1))</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">outer</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">fit</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">var</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">sigmas</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lwr </span><span style="color:#f92672">=</span> <span style="color:#e6db74">fit</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">const</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">vmat</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">upr </span><span style="color:#f92672">=</span> <span style="color:#e6db74">fit</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">const</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">*</span> <span style="color:#a6e22e">sqrt</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">vmat</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">if</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">nrow</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">xnew</span><span style="color:#960050;background-color:#1e0010">)==</span><span style="color:#a6e22e">1L</span><span style="color:#960050;background-color:#1e0010">){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ci </span><span style="color:#f92672">=</span> <span style="color:#e6db74">rbind(fit,</span> <span style="color:#a6e22e">lwr</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">upr</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">rownames</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">ci</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(&#34;</span><span style="color:#a6e22e">fit</span><span style="color:#960050;background-color:#1e0010">&#34;,</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">lwr</span><span style="color:#960050;background-color:#1e0010">&#34;,</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">upr</span><span style="color:#960050;background-color:#1e0010">&#34;)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">}</span> <span style="color:#a6e22e">else</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ci </span><span style="color:#f92672">=</span> <span style="color:#e6db74">array(0,</span> <span style="color:#a6e22e">dim</span><span style="color:#f92672">=</span><span style="color:#e6db74">c(nrow(xnew),</span> <span style="color:#a6e22e">m</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">dimnames</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">ci</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">list</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1:nrow</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">xnew</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">colnames</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">Y</span><span style="color:#960050;background-color:#1e0010">),</span> <span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(&#34;</span><span style="color:#a6e22e">fit</span><span style="color:#960050;background-color:#1e0010">&#34;,</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">lwr</span><span style="color:#960050;background-color:#1e0010">&#34;,</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">upr</span><span style="color:#960050;background-color:#1e0010">&#34;)</span> <span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ci</span><span style="color:#960050;background-color:#1e0010">[,,</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">]</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">fit</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ci</span><span style="color:#960050;background-color:#1e0010">[,,</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">]</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">lwr</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ci</span><span style="color:#960050;background-color:#1e0010">[,,</span><span style="color:#a6e22e">3</span><span style="color:#960050;background-color:#1e0010">]</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">upr</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">}</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ci</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>#95 CI Intervals and Print
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PMVM1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">pred</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">mlm</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">MVM1</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">NDMT1</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">level</span><span style="color:#f92672">=</span><span style="color:#e6db74">0.95,interval</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(&#34;</span><span style="color:#a6e22e">prediction</span><span style="color:#960050;background-color:#1e0010">&#34;))</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">print</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">PMVM1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><figure><img src="https://emr89.github.io/images/CI5.png"/>
</figure>

<h4 id="results-5">Results:</h4>
<p>sqrtPY = 17.1^2 = 292.41</p>
<p>Comp = 70.83%</p>
<p>TT = 2.633</p>
<p>sqrtRY = 12.23^2 = 149.5729</p>
<p>The range appears larger for the simulatenous Confidence Intervals compared to the one-at-a-time confidence intervals.</p>
<h3 id="assignment-6">Assignment 6:</h3>
<p>Construct covariance matrix, obtain eigenvalue and eigenvector for PCA, compute total portion by first two PCs.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Library and Dataset up
</span></span><span style="display:flex;"><span>AVWTP&lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">5:8</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#A ). covariance matrix 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">COVNWTP</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cov</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">AVWTP</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">COVNWTP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># correlation matrix 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CORNWTP</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cor</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">as</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">AVWTP</span><span style="color:#960050;background-color:#1e0010">))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CORNWTP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#B find eigenvalues and eigen vectors pairs
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PCA_AVWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">principal</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">AVWTP,nfactors</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">4</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;none&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PCA_AVWTP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Eigenvalues:
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">eigen</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CORNWTP</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><figure><img src="https://emr89.github.io/images/PCA1.png"/>
</figure>

<h4 id="results-for-eigenvalues">Results for Eigenvalues</h4>
<figure><img src="https://emr89.github.io/images/Eigen1.png"/>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#C ). Compute the proportion of Total variance explained by the first two Principle Components
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  #Located in this subsection
</span></span><span style="display:flex;"><span>PCA_AVWTP$loadings
</span></span></code></pre></div><figure><img src="https://emr89.github.io/images/PCALOAD1.png"/>
</figure>

<h4 id="results-6">Results:</h4>
<p>The proportion of the first PC is 42.4% of the total variation</p>
<p>The proportion od the second PC is 33.33% of the total variation</p>
<p>The cumulative proportion explained by the FIRST TWO PCS is 75.7% of the total variation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Calculate the coefficents of R
</span></span><span style="display:flex;"><span>CPCA &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">cor</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">PCA_AVWTP</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><h3 id="bonus-work-on-selecting-models">Bonus Work on selecting Models</h3>
<p>ALSO, we can find the best overall subset with given criteria for the model using glmulti. Additionally, given regsubset results, we can also use glmulti to find the best lm model effectivley for second level interactions</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#library(glmulti)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#GLMPY1&lt;- glmulti(sqrtPY~., data = NWTP,intercept=TRUE,level = 1, method = &#34;h&#34;, crit = &#34;bic&#34;)
</span></span><span style="display:flex;"><span># 262,144 models options for the following output
</span></span><span style="display:flex;"><span># Resulting best equation: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#GLMPY2&lt;- glmulti(sqrtPY~., data = NWTP,intercept=FALSE,level = 1, method = &#34;h&#34;, crit = &#34;bic&#34;)
</span></span><span style="display:flex;"><span># 262,144 models options for the following output
</span></span><span style="display:flex;"><span># Resulting best equation: sqrtPY~-1+TEAMS+FD+COMP+TAY+sqrtRY+BCCAY+logLCAD+BCAVG
</span></span><span style="display:flex;"><span>#exhaustive search up to 6 variables 
</span></span><span style="display:flex;"><span>#GLMPY6 &lt;- glmulti(sqrtPY~TEAMS+FD+COMP+TAY+sqrtRY+BCCAY, data = NWTP,intercept=FALSE,level = 2, method = &#34;h&#34;, crit = &#34;bic&#34;)
</span></span></code></pre></div><h4 id="resulting-best-equation">Resulting best equation:</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#GLMPYA&lt;- glmulti(sqrtPY~., data = NWTP,intercept=TRUE,level = 2, method = &#34;g&#34;, crit = &#34;bic&#34;)
</span></span><span style="display:flex;"><span>#GLMWTP&lt;- glmulti(TT~CAY+AGG+AYTS+COMP+EFF+EM+TLOS+AVG+CUSH+SEP+TAY+CTCH+YACR, data=SSWTP,intercept=TRUE,level = 1, method = &#34;h&#34;, crit = &#34;bic&#34;)
</span></span><span style="display:flex;"><span>#GLMWTP2&lt;- glmulti(TT~CAY+AGG+AYTS+COMP+EM+TLOS, data=SSWTP,intercept=TRUE,level = 2, method = &#34;h&#34;, crit = &#34;bic&#34;)
</span></span></code></pre></div><h3 id="assignment-7-from-textbookgrowth-curve-exersize">Assignment #7 from textbook:Growth Curve Exersize</h3>
<p>NOTE: My dataset did not seem appropriate for growth curves at the time so I did the example in the book.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Loading Libraries 
</span></span><span style="display:flex;"><span>library(ggplot2)
</span></span><span style="display:flex;"><span>library(psych)
</span></span><span style="display:flex;"><span>library(lavaan)
</span></span><span style="display:flex;"><span>library(lme4)
</span></span><span style="display:flex;"><span>library(nlme)
</span></span><span style="display:flex;"><span>library(readxl)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Read in File
</span></span><span style="display:flex;"><span>g2 &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">read_excel</span><span style="color:#960050;background-color:#1e0010">(&#34;</span><span style="color:#a6e22e">g2</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">xlsx</span><span style="color:#960050;background-color:#1e0010">&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#String Data
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">g2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Describe First 4 variables by gender
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">describeBy</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">g2</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">1:4</span><span style="color:#960050;background-color:#1e0010">],</span><span style="color:#a6e22e">group</span><span style="color:#f92672">=</span><span style="color:#e6db74">g2$gender)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Set variable = # of groups and separating them
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">len</span><span style="color:#f92672">=</span><span style="color:#e6db74">length(g2$gender)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">(1:len)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Then binding them to have data organized by Gender
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">g2</span><span style="color:#f92672">=</span><span style="color:#e6db74">cbind(id,g2)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">g2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Seperating Genders Females and Males: Describing them, creating Xbar, Creating covariance matrix
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Females:
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fg2</span><span style="color:#f92672">=</span><span style="color:#e6db74">g2[1:11,</span> <span style="color:#960050;background-color:#1e0010">]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fg2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">describe</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">fg2</span><span style="color:#960050;background-color:#1e0010">[,</span> <span style="color:#a6e22e">2:5</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Sf</span><span style="color:#f92672">=</span><span style="color:#e6db74">cov(fg2[,</span> <span style="color:#a6e22e">2:5</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Sf</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Xbarf</span><span style="color:#f92672">=</span><span style="color:#e6db74">cbind((colMeans(fg2[,</span> <span style="color:#a6e22e">2:5</span><span style="color:#960050;background-color:#1e0010">])))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Xbarf</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Males
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mg2</span><span style="color:#f92672">=</span><span style="color:#e6db74">g2[12:17,</span> <span style="color:#960050;background-color:#1e0010">]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mg2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">describe</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">mg2</span><span style="color:#960050;background-color:#1e0010">[,</span> <span style="color:#a6e22e">2:5</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Sm</span><span style="color:#f92672">=</span><span style="color:#e6db74">cov(mg2[,</span> <span style="color:#a6e22e">2:5</span><span style="color:#960050;background-color:#1e0010">])</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Sm</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Xbarm</span><span style="color:#f92672">=</span><span style="color:#e6db74">cbind((colMeans(mg2[,</span> <span style="color:#a6e22e">2:5</span><span style="color:#960050;background-color:#1e0010">])))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Xbarm</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculating S pooled
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Sp</span><span style="color:#f92672">=</span><span style="color:#e6db74">(1/(17-2))*((11-1)*Sf</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">6-1</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">Sm</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculating W
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">W</span><span style="color:#f92672">=</span><span style="color:#e6db74">(17-2)*Sp</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Inverse of S pooled 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SpI</span><span style="color:#f92672">=</span><span style="color:#e6db74">solve(Sp)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#create Matrix for transformations and powers of ages
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">matrix</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">8</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">64</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">512</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">10</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">100</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">1000</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">12</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">144</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">1728</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">14</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">196</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">2744</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">nrow </span><span style="color:#f92672">=</span> <span style="color:#e6db74">4,ncol</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">4</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Transpose of B
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">TB</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">t</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">B</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Transpose of B * Inverse of I * B
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P </span><span style="color:#f92672">=</span> <span style="color:#e6db74">(TB</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">SpI</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Inverse of Product
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PI</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">solve</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">P</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculating Products for Female group 
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">BHFE</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">PI</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">TB</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">SpI</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">Xbarf</span> <span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculating Products for Male group 
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">BHMA </span><span style="color:#f92672">=</span> <span style="color:#e6db74">PI</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">TB</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">SpI</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">Xbarm</span> <span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calcuating Critical Value
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">k</span><span style="color:#f92672">=</span><span style="color:#e6db74">((17-2)*(17-2-1))/((17-2-4+3)*(17-2-4+3+1))</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">k</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">11</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">PI</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">((</span><span style="color:#a6e22e">k</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">6</span><span style="color:#960050;background-color:#1e0010">)*</span><span style="color:#a6e22e">PI</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Creating Wilks Matrix for Women 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">as.matrix(fg2[,2:5])</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Wf</span><span style="color:#f92672">=</span><span style="color:#e6db74">cbind(c(0,0,0,0),c(0,0,0,0),c(0,0,0,0),c(0,0,0,0))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Wf</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">for</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">i</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">1:11</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Wf</span><span style="color:#f92672">=</span> <span style="color:#e6db74">Wf</span> <span style="color:#960050;background-color:#1e0010">+</span>  <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,])</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">BHFE</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">%*%</span> 
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#a6e22e">t</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,])</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">BHFE</span><span style="color:#960050;background-color:#1e0010">)</span>   
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Creating Wilks Matrix for Men 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Wm</span><span style="color:#f92672">=</span><span style="color:#e6db74">cbind(c(0,0,0,0),c(0,0,0,0),c(0,0,0,0),c(0,0,0,0))</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Wm</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">for</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">i</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">1:6</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Wm</span><span style="color:#f92672">=</span> <span style="color:#e6db74">Wm</span> <span style="color:#960050;background-color:#1e0010">+</span>  <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,])</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">BHMA</span><span style="color:#960050;background-color:#1e0010">)</span> <span style="color:#960050;background-color:#1e0010">%*%</span> 
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">t</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">cbind</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">i</span><span style="color:#960050;background-color:#1e0010">,])</span> <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">B</span> <span style="color:#960050;background-color:#1e0010">%*%</span> <span style="color:#a6e22e">BHMA</span><span style="color:#960050;background-color:#1e0010">)</span>   
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Combining for Interaction Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">WE</span><span style="color:#f92672">=</span><span style="color:#e6db74">Wf+Wm</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculating General W
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">W</span><span style="color:#f92672">=</span><span style="color:#e6db74">(17-2)*Sp</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculating Lambda Likelihood Ratio test 
</span></span><span style="display:flex;"><span>  #W/ <span style="color:#a6e22e">HO</span> <span style="color:#a6e22e">stating</span> <span style="color:#a6e22e">that</span> <span style="color:#a6e22e">q-order</span> <span style="color:#a6e22e">polynomial</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">sufficent</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">LAMBDA</span><span style="color:#f92672">=</span><span style="color:#e6db74">det(W)/det(WE))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">-17</span><span style="color:#960050;background-color:#1e0010">+((</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">)*(</span><span style="color:#a6e22e">4-3</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">)))*</span><span style="color:#a6e22e">log</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">LAMBDA</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><p>It appears 3 is the best choice</p>
<h3 id="assignment-8">Assignment 8:</h3>
<p>Exploratory Factor Analysis:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Set Up Dataset
</span></span><span style="display:flex;"><span>DWTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1:7</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Create Covariance and Correlation Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cov(DWTP)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cor(DWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Maximum-likelihood factor analysis and Results:
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">FA1 </span><span style="color:#f92672">=</span><span style="color:#e6db74">factanal(DWTP,factors=1,cutoff=0.00000001,rotation=&#34;none&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">FA1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">digits</span><span style="color:#f92672">=</span><span style="color:#e6db74">5,cutoff=0.00000001)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">FA1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">FA1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><h4 id="results-7">Results</h4>
<figure><img src="https://emr89.github.io/images/FA1.png"/>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Specifiy Loadings 
</span></span><span style="display:flex;"><span>LFA1=loadings(FA1)
</span></span><span style="display:flex;"><span>LFA1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#M=2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Maximum-likelihood factor analysis and Results:
</span></span><span style="display:flex;"><span>FA2=factanal(DWTP,factors=2,cutoff=0.00000001)
</span></span><span style="display:flex;"><span>print(FA2,digits=5,cutoff=0.00000001)
</span></span><span style="display:flex;"><span>FA2
</span></span><span style="display:flex;"><span>summary(FA2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Specifiy Loadings 
</span></span><span style="display:flex;"><span>LFA2=loadings(FA2)
</span></span><span style="display:flex;"><span>LFA2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Perform maximum-likelihood factor analysis covariance matrix W/ Loadings:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Factors = 1 
</span></span><span style="display:flex;"><span>m1=factanal(x=NULL,factors=1,covmat=SDWTP,n.obs=337,cutoff=0.00000001,rotation=&#34;none&#34;)
</span></span><span style="display:flex;"><span>m1$loadings
</span></span><span style="display:flex;"><span>m1
</span></span><span style="display:flex;"><span>summary(m1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Factors = 2 
</span></span><span style="display:flex;"><span>m2 =factanal(x=NULL,factors=2,covmat=SDWTP,n.obs=337,cutoff=0.00000001,rotation=&#34;none&#34;)
</span></span><span style="display:flex;"><span>print(m2,digits=5,cutoff=0.00000001)
</span></span><span style="display:flex;"><span>m2
</span></span><span style="display:flex;"><span>summary(m2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Using Correlation matrix Now W/ Loadings
</span></span><span style="display:flex;"><span># Factors = 1 
</span></span><span style="display:flex;"><span>m3=factanal(x=NULL,factors=1,covmat=RDWTP,n.obs=337,cutoff=0.00000001,rotation=&#34;none&#34;)
</span></span><span style="display:flex;"><span>m3
</span></span><span style="display:flex;"><span>summary(m3)
</span></span><span style="display:flex;"><span>m3$loadings
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Factors = 2
</span></span><span style="display:flex;"><span>m4 =factanal(x=NULL,factors=2,covmat=RDWTP,n.obs=337,cutoff=0.00000001,rotation=&#34;none&#34;)
</span></span><span style="display:flex;"><span>m4
</span></span><span style="display:flex;"><span>summary(m4)
</span></span><span style="display:flex;"><span>print(m2,digits=5,cutoff=0.00000001)
</span></span></code></pre></div><h4 id="print-m1m2m3m4-and-lfa2-fa2-lfa1">Print m1,m2,m3,m4 and LFA2, FA2 LFA1</h4>
<p><figure><img src="https://emr89.github.io/images/FA2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/m1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/m2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/m3.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/m4.png"/>
</figure>
</p>
<h3 id="assignment-9">Assignment 9:</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>  #Loading Library and Setting Up Dataset
</span></span><span style="display:flex;"><span>library(psych)
</span></span><span style="display:flex;"><span>DWTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1:7</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Create Covariance and Correlation Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cov(DWTP)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cor(DWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Principle Component Analysis W/ Covariance Matrix
</span></span><span style="display:flex;"><span>#M=1
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pc1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">principal</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">SDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pc1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">pc1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><h4 id="results-8">Results</h4>
<figure><img src="https://emr89.github.io/images/PC1.png"/>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Specific Variances
</span></span><span style="display:flex;"><span>pc1$uniqueness
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Residuals 
</span></span><span style="display:flex;"><span>pc1$residual
</span></span></code></pre></div><figure><img src="https://emr89.github.io/images/PC1REM.png"/>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># m = 2 
</span></span><span style="display:flex;"><span>pc2 &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">principal</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">SDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">2,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">pc2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pc2</span>
</span></span><span style="display:flex;"><span>#Specific Variances
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pc2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">uniqueness</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Residuals 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pc2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residual</span>
</span></span></code></pre></div><h4 id="results-9">Results</h4>
<p><figure><img src="https://emr89.github.io/images/PC2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/PC2REM.png"/>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Factor Analysis using &#34;ML&#34;
</span></span><span style="display:flex;"><span>#Factors = 1 
</span></span><span style="display:flex;"><span>AF1 &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">fa</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">SDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculated Loadings and communalities
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">loadings</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">communalities</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Specific Variation and Overall Residuals 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">uniquenes</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residual</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># m = 2
</span></span><span style="display:flex;"><span>#Factors = 2
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF2</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fa</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">SDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">2,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">TRUE)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Calculated Loadings and communalities
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">loadings</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">communalities</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Specific Variation and Overall Residuals 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">uniquenes</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">AF2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residual</span>
</span></span></code></pre></div><h4 id="results-10">Results</h4>
<p><figure><img src="https://emr89.github.io/images/AF1P1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/AF1P2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/AF2P1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/AF2P2.png"/>
</figure>
</p>
<p>Part C:</p>
<p>It is clear that in this case, the Principle component analysis works far better than the mle. Additionally, when there are 2 factors, the analysis grows far stronger, but its due to the extreme variation in the data.</p>
<h3 id="assignment-10">Assignment #10:</h3>
<p>Perform Factor Analysis using Correlation Matrix</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Library and Set up Dataset
</span></span><span style="display:flex;"><span>library(psych)
</span></span><span style="display:flex;"><span>DWTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1:7</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Create Covariance and Correlation Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cov(DWTP)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cor(DWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Principle Component Analysis with 1 Factor.
</span></span><span style="display:flex;"><span>#With Specific Variation and Residuals 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A1</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">principal</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">RDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">P2A1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">uniqueness</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residuals</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Principle Component Analysis with 2 Factors.
</span></span><span style="display:flex;"><span>#With Specific Variation and Residuals 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A2</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">principal</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">RDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">2,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">P2A2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">uniqueness</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">P2A2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residuals</span>
</span></span></code></pre></div><h4 id="results-11">Results</h4>
<p><figure><img src="https://emr89.github.io/images/P2A1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/P2A2.png"/>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Factor Analysis USing &#34;ML&#34;, With 1 Factor
</span></span><span style="display:flex;"><span>#W/ communalities and residuals
</span></span><span style="display:flex;"><span>A1F1 &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">fa</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">RDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">1,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">A1F1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">A1F1</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">A1F1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">communalities</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">A1F1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residual</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Factor Analysis USing &#34;ML&#34;, With 2 Factors
</span></span><span style="display:flex;"><span>#W/ communalities and residuals
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">A1F2</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fa</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">r</span><span style="color:#f92672">=</span><span style="color:#e6db74">RDWTP,</span> <span style="color:#a6e22e">nfactors </span><span style="color:#f92672">=</span> <span style="color:#e6db74">2,</span> <span style="color:#a6e22e">rotate </span><span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;none&#39;</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">covar </span><span style="color:#f92672">=</span> <span style="color:#e6db74">FALSE)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">A1F2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">A1F2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">A1F2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">communalities</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">A1F2</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residual</span>
</span></span></code></pre></div><h4 id="results-12">Results</h4>
<p><figure><img src="https://emr89.github.io/images/A1F1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/A1F1RES.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/A1F2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/A1F2RES.png"/>
</figure>
</p>
<p>Does it make a difference if R, rather than S is factored? Explain.</p>
<p>It makes a difference because the Maximum Likelihood estimator is more telling of a stronger principal component. A review of the residual matrices indicates MLE still performs better than the principal component solution. Additionally, it appears that having m=2 makes the Factor Analyses and Principal component stronger, which is probably due to how many variables there are in the dataset.</p>
<h3 id="assignment-11">Assignment #11:</h3>
<p>generate a)specific variances b)communalities #c)proportion of variance explained by each factor d)residual matrix</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Library and Set up dataset
</span></span><span style="display:flex;"><span>library(psych)
</span></span><span style="display:flex;"><span>DWTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1:7</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Create Covariance and Correlation Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cov(DWTP)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RDWTP</span><span style="color:#f92672">=</span><span style="color:#e6db74">cor(DWTP)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Factor Analysis with Correlation Matrix &amp; Print
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">F2A1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">fa</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">RDWTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">nfactors</span><span style="color:#f92672">=</span><span style="color:#e6db74">2,n.obs=337,rotate=&#34;none&#34;,fm=&#34;ml&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">F2A1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">digits</span><span style="color:#f92672">=</span><span style="color:#e6db74">5,cutoff=0.00000001)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#A). Specific Variances
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">F2A1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">uniquenesses</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#B).Communalities
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">F2A1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">communalities</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#C). the proportion of variance explained by each factor
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">F2A1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">loadings</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#D). Residual Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">F2A1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">residual</span>
</span></span></code></pre></div><h4 id="results-13">Results</h4>
<p><figure><img src="https://emr89.github.io/images/F2A1P1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/F2A1P2.png"/>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Factor Analysis with 2 facts, and correlaton matrix &amp; Print
</span></span><span style="display:flex;"><span>CTA1 &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">factanal</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">NULL,factors=2,covmat=RDWTP,n.obs=337,cutoff=0.00000001,rotation=&#34;none&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">print</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CTA1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">digits</span><span style="color:#f92672">=</span><span style="color:#e6db74">5,cutoff=0.00000001)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#A). Specific Variances
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CTA1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">uniquenesses</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#B).Communalities (had to google)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">rowSums</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CTA1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">loadings</span><span style="color:#960050;background-color:#1e0010">^</span><span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#C). the proportion of variance explained by each factor
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CTA1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">loadings</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#D). Residual Matrix
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">factor</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">residuals</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">RDWTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">CTA1</span><span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">loadings</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><h4 id="results-14">Results</h4>
<p><figure><img src="https://emr89.github.io/images/CTA1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CTA1P1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CTA1P2.png"/>
</figure>
</p>
<h3 id="assignment-12">Assignment #12:</h3>
<p>a) Compute the canonical correlations</p>
<p>b) Test for the significance of the canonical correlations with alpha=0.01.</p>
<p>c) Generate two plots using the function helio.plot: one plot for cv=1 and one plot for cv=2.</p>
<p>d) Write a paragraph describing the information displayed in the plots.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Library and Set up dataset
</span></span><span style="display:flex;"><span>library(yacca)
</span></span><span style="display:flex;"><span>QB &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">5:7</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">11</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">15</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">16</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RBWR</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">8:10</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">12</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">17:19</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">TP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1:4</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">13:14</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Correlation of all variables used 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">RAWTP</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cor</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#canonical correlation
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">3</span> <span style="color:#a6e22e">Separate</span> <span style="color:#a6e22e">types</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">determine</span> <span style="color:#a6e22e">find</span> <span style="color:#a6e22e">Linear</span> <span style="color:#a6e22e">Combinations</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">relations</span> <span style="color:#a6e22e">among</span> <span style="color:#a6e22e">type</span> <span style="color:#a6e22e">of</span> <span style="color:#a6e22e">variables</span><span style="color:#960050;background-color:#1e0010">.</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CCN1</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cca</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">QB,y=RBWR,xlab</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">colnames</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">QB</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">ylab </span><span style="color:#f92672">=</span> <span style="color:#e6db74">colnames(RBWR),standardize.scores</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">TRUE</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CCN2</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cca</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">QB,y=TP,xlab</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">colnames</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">QB</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">ylab </span><span style="color:#f92672">=</span> <span style="color:#e6db74">colnames(TP),standardize.scores</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">TRUE</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">CCN3</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">cca</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">x</span><span style="color:#f92672">=</span><span style="color:#e6db74">RBWR,y=TP,xlab</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">colnames</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">RBWR</span><span style="color:#960050;background-color:#1e0010">),</span><span style="color:#a6e22e">ylab </span><span style="color:#f92672">=</span> <span style="color:#e6db74">colnames(TP),standardize.scores</span> <span style="color:#960050;background-color:#1e0010">=</span> <span style="color:#a6e22e">TRUE</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Helio Plots For all canonical correlation models w/ plot of cv1&amp;cv2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#CCN1
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">helio</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CCN1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">cv</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">helio</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CCN1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">cv</span><span style="color:#f92672">=</span><span style="color:#e6db74">2)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#CCN2
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">helio</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CCN2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">cv</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">helio</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CCN2</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">cv</span><span style="color:#f92672">=</span><span style="color:#e6db74">2)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#CCN3
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">helio</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CCN3</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">cv</span><span style="color:#f92672">=</span><span style="color:#e6db74">1)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">helio</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">CCN3</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">cv</span><span style="color:#f92672">=</span><span style="color:#e6db74">2)</span>
</span></span></code></pre></div><h4 id="results-15">Results:</h4>
<p><figure><img src="https://emr89.github.io/images/CCN1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CCN1P2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CCN2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CCN2P2.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CCN3.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/CCN3P2.png"/>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Chi squared values for Bartlett&#39;s Test
</span></span><span style="display:flex;"><span>CCN1$chisq
</span></span><span style="display:flex;"><span>CCN1$df
</span></span><span style="display:flex;"><span>qchisq(.99,CCN1$df[1],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN1$df[2],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN1$df[3],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN1$df[4],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN1$df[5],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN1$df[6],ncp=0)
</span></span><span style="display:flex;"><span>F.test.cca(CCN1)
</span></span></code></pre></div><h4 id="results-16">Results</h4>
<figure><img src="https://emr89.github.io/images/FCCN1.png"/>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#CCN2
</span></span><span style="display:flex;"><span>CCN2$chisq
</span></span><span style="display:flex;"><span>CCN2$df
</span></span><span style="display:flex;"><span>qchisq(.99,CCN2$df[1],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN2$df[2],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN2$df[3],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN2$df[4],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN2$df[5],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN2$df[6],ncp=0)
</span></span><span style="display:flex;"><span>F.test.cca(CCN2)
</span></span></code></pre></div><h4 id="results-17">Results</h4>
<figure><img src="https://emr89.github.io/images/FCCN2.png"/>
</figure>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#CCN3
</span></span><span style="display:flex;"><span>CCN3$chisq
</span></span><span style="display:flex;"><span>CCN3$df
</span></span><span style="display:flex;"><span>qchisq(.99,CCN3$df[1],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN3$df[2],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN3$df[3],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN3$df[4],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN3$df[5],ncp=0)
</span></span><span style="display:flex;"><span>qchisq(.99,CCN3$df[6],ncp=0)
</span></span><span style="display:flex;"><span>F.test.cca(CCN3)
</span></span></code></pre></div><h4 id="results-18">Results</h4>
<figure><img src="https://emr89.github.io/images/FCCN3.png"/>
</figure>

<p>These plots highlight that there is a substantial amount of linear correlations among the variables present in both the x and y variables. The higher the boxes stack, the more canonical correlation the variables have, and possibly can be considered linear combinations of other variables. The one major variable that has a negative correlation is the BCEFF, as its the variable whose box is pointed most inside compared to the rest. The positive correlation is when the box goes outward from the circle . The closer the boxes are to the darked center line, the less canonical correlated they are to other variables.</p>
<h3 id="assignment-13">Assignment 13:</h3>
<p>Euclidean Distances and dendrograms, compare results and determine if there are several clusters</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Library and Set up dataset
</span></span><span style="display:flex;"><span>library(&#34;stats&#34;)
</span></span><span style="display:flex;"><span>library(cluster)
</span></span><span style="display:flex;"><span>TWTP &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">WTP</span><span style="color:#960050;background-color:#1e0010">[,</span><span style="color:#a6e22e">c</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">4:5</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">7:8</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">19:22</span><span style="color:#960050;background-color:#1e0010">)]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Euclidean Distances
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ED</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">dist</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">TWTP</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;euclidean&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Creating Dendrograms
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EDH</span> <span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">-</span> <span style="color:#a6e22e">hclust</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">ED</span><span style="color:#960050;background-color:#1e0010">,</span><span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;average&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">plot</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">EDH</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span></code></pre></div><h4 id="results-19">Results</h4>
<figure><img src="https://emr89.github.io/images/CD1.png"/>
</figure>

<p>DO There Appear to be Several Clusters?</p>
<p>There appears to be several clusters that have a slight assoiciation together, yet makes up a vast array of influential factors.</p>
<h3 id="assignment-14">Assignment #14:</h3>
<p>K means cluster algorithm, compare to assignment 13, are there about the right number of clusters</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span># Library and Set up dataset
</span></span><span style="display:flex;"><span>library(&#34;stats&#34;)
</span></span><span style="display:flex;"><span>library(cluster)
</span></span><span style="display:flex;"><span>library(NbClust)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Creating clusters, min = 2, max =15, by he kmeans method
</span></span><span style="display:flex;"><span>nc &lt;<span style="color:#f92672">-</span> <span style="color:#a6e22e">NbClust</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">NWTP</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">min</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">nc</span><span style="color:#f92672">=</span><span style="color:#e6db74">2,</span> <span style="color:#a6e22e">max</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">nc</span><span style="color:#f92672">=</span><span style="color:#e6db74">15,</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;kmeans&#34;</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Set up random Generation
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">set</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">seed</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1234</span><span style="color:#960050;background-color:#1e0010">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Simulating 5 clusters 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fit5 </span><span style="color:#f92672">=</span> <span style="color:#e6db74">kmeans(NWTP,</span> <span style="color:#a6e22e">centers</span><span style="color:#f92672">=</span><span style="color:#e6db74">5,</span>  <span style="color:#a6e22e">nstart</span><span style="color:#f92672">=</span><span style="color:#e6db74">25)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fit5</span>
</span></span></code></pre></div><h4 id="simulating-5-clusters">Simulating 5 clusters</h4>
<p><figure><img src="https://emr89.github.io/images/fit5p1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/fit5p2.png"/>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Euclidean cluster plot 
</span></span><span style="display:flex;"><span>clusplot(pam(NWTP,5,metric=&#34;euclidean&#34;)) 
</span></span><span style="display:flex;"><span>#Simulating 5 clusters 
</span></span><span style="display:flex;"><span>fit6= kmeans(NWTP, centers=6,  nstart=25)
</span></span><span style="display:flex;"><span>fit6
</span></span></code></pre></div><h4 id="simulating-6-clusters">Simulating 6 clusters</h4>
<p><figure><img src="https://emr89.github.io/images/fit6p1.png"/>
</figure>

<figure><img src="https://emr89.github.io/images/fit6p2.png"/>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>#Euclidean cluster plot 
</span></span><span style="display:flex;"><span>clusplot(pam(NWTP,6,metric=&#34;euclidean&#34;))
</span></span></code></pre></div><h4 id="results-20">Results</h4>
<figure><img src="https://emr89.github.io/images/CLPL.png"/>
</figure>

<ul class="pa0">
  
   <li class="list di">
     <a href="https://emr89.github.io/tags/scene/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Scene</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="https://emr89.github.io/post/fifa-world-cup-match-prediction/">FIFA World Cup Match Prediction</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://emr89.github.io/post/nfl-big-data-bowl-2021-2022/">NFL Big Data Bowl 2021-2022</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://emr89.github.io/post/2020-supplemental-football-match-up-analysis/">2020 Supplemental Football Match Up Analysis</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://emr89.github.io/post/super-bowl-53-analysis/">Super Bowl 53 Analysis</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://emr89.github.io/post/nfl-performance/">NFL Performance Research &amp; Prediction</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://emr89.github.io/" >
    &copy;  Eric Matthew Rupinski  2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
